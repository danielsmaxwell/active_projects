---
title: "One Sample Test (T-Test) (Instructional Worksheet)"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<script src="hideOutput.js"></script>

<link rel="stylesheet" type="text/css" href="fold.css">

#\textcolor{blue}{1.1} One Sample T-Test

**Goal:** Compare the mean value of a sample ($\mu$) with a constant value ($\mu_0$). 

We are interested in whether the following null or alternate hypotheses is supported by the data.

$$H_0: \mu = \mu_0$$
$$H_1: \mu \ne \mu_0$$

Because we are interested in comparing the population mean of one sample to a constant value, we will use a one sample t-test. In R, we use the *t.test()* function. 
For this module we will use the *anorexia* built-in dataset that is within the *MASS* package. Remember you need to load the package first before you can load the data. This data set gives us the weight before and after a study for patients that received one of three treatments (control, cognitive behavioral treatment, family treatment).

```{r eval = FALSE}
library(MASS)
data(anorexia)
t.test(anorexia$Postwt, mu = 100)
```

The above code compares the mean weight of all patient at the end of the study to a mean weight of 100 pounds. If we look at the output, we are given the t-value, the degrees of freedom (df), the p-value, the 95% confidence interval, and the sample estimates. From these results, we know the actual mean weight for all patients is 85 lbs, with a confidence interval of 83 to 87. Because the confidence interval does not cross the given constant mean (100), our results support the alternative hypothesis, the true mean is not equal to the constant given mean (100). We also know this because the p-value is significant (less than 0.05). 

In this example, we are running a 2-sided one sample t-test because we are interested in whether or not the mean of the sample is equal or not equal to the constant mean of 100. If we are intersted in whether or not the sample mean is greater than or less than the constant mean, we can run a 1-sided one sample t-test instead. 

```{r eval = FALSE}
t.test(anorexia$Postwt, mu = 100, alternative = "less")
t.test(anorexia$Postwt, mu = 100, alternative = "greater")
```

From these two test results, we can see that the true sample mean is less than the constant mean of 100. 

Finally, if we want a different percent confidence interval in our results, we can change the value in our *t.test()* function. Let's change it to 99%.

```{r eval = FALSE}
t.test(anorexia$Postwt, mu = 100, conf.level = 0.99)
```

You'll notice that the confidence interval presented is now 99%, but all of the other results are the same.

#\textcolor{blue}{1.2} Problem Set

1. Using the *anorexia* dataset again, let's run a one sample t-test to see if the mean weight for patients after the study who receive the family treatment is equal or not equal to 80 pounds. Remember that we are only interested in patients that received the family treatment now, so make sure you subset your dataset for this particular treatment.

2. Is the mean weight for patients after the study who received the family treatment significantly different than 80 pounds? How do you know?

3. What is the 95% confidence interval? the 99% confidence interval?

4. Now, run a one sample t-test comparing the mean weight of patients after the study receiving the family treatment to a constant weight of 100 pounds. What are your conclusions?

After you have completed the problem set, click the Code button to see the solution.


<div class="fold s">

```{r eval = FALSE}
t.test(anorexia$Postwt[anorexia$Treat== "FT"], mu = 80)

#patient weight is significantly different than 80 lbs
#p value = 0.0001059 (<0.05)
#confidence interval does not cross 80
#reject null hypothesis

#95% confidence interval (86.14 - 94.85)
t.test(anorexia$Postwt[anorexia$Treat=="FT"], mu=80, conf.level = 0.99)
#99% confidence interval (84.49 - 96.50)

t.test(anorexia$Postwt[anorexia$Treat=="FT"], mu=90)
#patient weight is not significantly different than 90 lbs 
#p value 0.8131
#95% confidence interval (86.14 - 94.85) - does cross 90
#support null hypothesis
```

</div>

