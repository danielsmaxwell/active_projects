---
title: "Data Management in R (Instructional Worksheet)"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<script src="hideOutput.js"></script>

<link rel="stylesheet" type="text/css" href="fold.css">

#\textcolor{blue}{1.0} Creating Graphs

## Basic Plot

We will use the built-in data set *women* to create plots in R. This dataset provides the average heights and weights for American women between the ages of 30 and 39.   

Let's create a plot with height (in) on the x-axis and weight (lbs) on the y-axis.

```{r fig.width = 5, fig.height = 5}
plot(women$height, women$weight)
```

What does this plot tell us?  

As height increases so does weight.

Let's customize the plot to make it easier to read. There are many arguments that can be added to the plot command. Here are some examples:

* Type - the type of plot to be drawn (Points(default) or Lines)
* Main - the title of the plot
* Xlab, Ylab - the axis labels
* Xlim, Ylim - the range of values on each axis
* Col - color of symbols

Let's add these arguments to our height/weight plot. Let's now make a line plot, instead of a point plot - add a title and axis labels - and change the color to blue. 

```{r fig.width = 5, fig.height = 5}
plot(women$height, women$weight, 
     type = "l", 
     main = "Women Height vs. Weight", 
     xlab = "Height (in)", 
     ylab = "Weigth (lbs)", 
     col = "blue")
```

Now this plot is a lot easier to read!


## Other Common Plots

## Barplot  

A barplot is a graphical way to display and compare the values of different categories within a dataset.  

Create a barplot for the following vector and add labels for each bar.  

```{r fig.width = 5, fig.height = 5}
data <- c(4,6,3)

names(data) <- c("Rwanda", "USA", "England")

barplot(data)

abline(h=mean(data)) #adds a horizontal line to the graph at the mean value
```

## Boxplot  

A boxplot shows the distribution of the data based on the five number summary: minimum, first quartile, median, third quartile, and maximum.  

Create a side-by- side boxplot for the *women* built-in dataset that we were using before.

```{r fig.width = 5, fig.height = 5}

boxplot(women$height, women$weight, main = "Average Women's Height/Weight", names = c("Height", "Weight"))
```

## Histogram  

A histogram is a graphical way to represent the distribution of a dataset. The bars represent the frequency of each value within the dataset.  

Let's go back to the *survey* data that we used in the last module. Remember you first need to load the *MASS* package and then the dataset to use it. 

We will create a histogram of the age of students who were surveyed in this dataset.

```{r fig.width = 5, fig.height = 5}
library(MASS)
data(survey)
hist(survey$Age, xlab = "Age", main = "Histogram of Student Ages")
```

Add a green vertical line to show the mean age.  

```{r fig.width = 5, fig.height = 5}
hist(survey$Age, xlab = "Age", main = "Histogram of Student Ages")

abline(v=mean(survey$Age), col = "green")
```

## Multiple Plots    

Next let's learn how to create multiple plots on the same page, as well as one plot with multiple sets of data. 

We will use the built-in data set *epil*, which gives the number of seizures that were recorded in each 2 week period for 59 different patients, who were given one of two treatments. 

Let's create a line plot showing the number of seizures for each period for patient 1 and another line plot for patient 2.

```{r fig.width = 5, fig.height = 5}
plot(epil$period[epil$subject == 1], epil$y[epil$subject == 1], 
     main = "Number of Seizures each Period for Patient 1", 
     xlab = "Period", 
     ylab = "Number of Seizures", 
     col = "orange", 
     type = "l")

plot(epil$period[epil$subject == 2], epil$y[epil$subject == 2], 
     main = "Number of Seizures each Period for Patient 2", 
     xlab = "Period", 
     ylab = "Number of Seizures", 
     col = "purple", 
     type = "l")
```

Now, let's keep these same plots - but what if we want them both on the same page, for example for in a publication?

```{r fig.width = 5, fig.height = 5}
par(mar = c(2, 2, 2, 2))
par(mfrow=c(2,1)) # Two rows and one column of plots on the page

plot(epil$period[epil$subject == 1], epil$y[epil$subject == 1], 
     main = "Number of Seizures each Period for Patient 1", 
     xlab = "Period", 
     ylab = "Number of Seizures", 
     col = "orange", 
     type = "l")

plot(epil$period[epil$subject == 2], epil$y[epil$subject == 2], 
     main = "Number of Seizures each Period for Patient 2", 
     xlab = "Period", 
     ylab = "Number of Seizures", 
     col = "purple", 
     type = "l")
```
 
If we want to instead have two columns and one row of plots (i.e. two plots side by side) we would use *par(mfrow=c(1,2))*. For two columns and three rows (i.e. six plots total on page) we would use *par(mfrow=c(3,2))* and so forth.  

> ### Note: After changing the number of columns/rows on the page - it is necessary to change it back to 1 row and 1 column to have just one plot on the page again *(par(mfrow=c(1,1))*.  

## Multiple Sets of Data on the Same Plot & Legend  

Now, let's use the same data for the number of seizures, but create just one plot showing the data for both patients. We will also include a legend to show which set of data relates to which patient. 

Now let's put the window back to one column and one row, and then create a plot of the patient 1 data in blue - the same way we created plots before. 

```{r eval=FALSE}
par(mfrow=c(1,1))

plot(epil$period[epil$subject == 1], epil$y[epil$subject == 1], 
     main = "Number of Seizures each Period for Patient 1", 
     xlab = "Period", 
     ylab = "Number of Seizures", 
     col = "blue", 
     type = "l")
```

Now, let's add the patient 2 data to the same plot using the *lines* command. If we wanted to add the data as points instead of the lines we would use the *points* command. We will plot the patient 2 data in red.

```{r eval=FALSE}
lines(epil$period[epil$subject == 2], epil$y[epil$subject == 2], 
     col = "red")
```

For the last step, let's add a legend to the plot so that we know which set of data represent which patient. We will put the legend in the top right corner of the plot. Then put it all together.

```{r fig.width = 6, fig.height = 6}
par(mfrow=c(1,1))

plot(epil$period[epil$subject == 1], epil$y[epil$subject == 1], 
     main = "Number of Seizures each Period for Patient 1", 
     xlab = "Period", 
     ylab = "Number of Seizures", 
     col = "blue", 
     type = "l")

lines(epil$period[epil$subject == 2], epil$y[epil$subject == 2], 
     col = "red")

legend("topright", col = c("blue", "red"), lty = 1, legend = c("Patient 1", "Patient 2"))
```

In the above R code, you'll notice the *lty* argument. This stands for line type, with line type 1 as the solid line - try switching it to other numbers between 1 and 6 for other line types. If you had a plot using points instead of lines, you would use the *pch* command instead - which stands for point character. Point character 16 is a solid circle. Try using point characters 0-25 for different symbols!  

\newpage  

#\textcolor{blue}{1.1} Problem Set

1. For this problem set we are going to continue using the *epil* datset, but now we are interested in Patient 3 and Patient 4. If it is easier, you can create a new data frame for patient 3 and patient 4 to use in your plotting, or you can use the main data set and subset for the particular patient like we did above. 

2. Create a plot of the number of seizures for patient 3 with the period on the x-axis. Include a title, axis labels, and make the points blue. Can you figure out how to change the open circle points to another shape? Try and change them to closed circles. Is the number of seizures increasing or decreasing over time? What is the minimum and maximum number of seizures?

3. Create a plot of the number of seizures for patient 4 with the period on the x-axis. This time make it a line plot. Include a title, axis labels, and then make the line dark green. Can you figure out how to change the line type to a dotted line? What is the minimum and maximum number of seizures?  

4. Put the two plots that you just made onto one page with one column and two rows.  

5. Create a line plot of the number of seizures for patient 3. On the same plot add the number of seizures for patient 4 as points. Make the patient 3 line purple and the patient 4 points red. Includes a title and axis labels.

6. Add a legend to the top left of the plot you just made - make sure next to patient 3 you have a purple line, and next to patient 4 you have a red point.

7. Create a barplot showing the minimum number of seizures for patient 3 and 4. Make sure to include a title and labels for each of the bars.  

8. Create a side-by- side boxplot of the number of seizures for chick 3 and 4 - make sure to include a title, and a label below each box to show which patient it represents.  

9. Create a histogram of the number of seizures for patient 3. Add an orange vertical line to show the mean number of seizures.

After you have completed the problem set, click the Code button to see the solution.

<div class="fold s">

```{r eval = FALSE}
patient3 <- epil[epil$subject == 3,]
patient4 <- epil[epil$subject == 4,]

plot(patient3$period, patient3$y, main = "Patient 3 Number of Siezures", xlab = "Period", ylab = "Number of Seizures", col = "blue", pch = 16)
#pch is the point character - change to 16 for closed circles
#increasing between periods 1 and 2 then decreasing then increasing to highest
#at period 4
min(patient3$y) #0 seizures
max(patient3$y) #5 seizures

plot(patient4$period, patient4$y, type = 'l', main = "Patient 4 Number of Seizures", xlab = "Period", ylab = "Number of Seizures", col = "darkgreen", lty = 2)
#lty is line type - change to 2 for dotted line
min(patient4$y) #1 seizure
max(patient4$y) #4 seizures

par(mfrow=c(2,1))
plot(patient3$period, patient3$y, main = "Patient 3 Number of Seizures", xlab = "Period", ylab = "Number of Seizures", col = "blue", pch = 16)
plot(patient4$period, patient4$y, type = 'l', main = "Patient 4 Number of Seizures", xlab = "Period", ylab = "Number of Seizures", col = "darkgreen", lty = 2)

par(mfrow=c(1,1))
plot(patient3$period, patient3$y, type='l', main = "Number of Seizures", xlab = "Period", ylab = "Number of Seizures", col = "purple")
points(patient4$period, patient4$y, col = "red")
legend("topleft", legend=c("Patient 3", "Patient 4"), lty = c(1,NA), pch = c(NA,1), col = c("purple", "red"))

barplot(c(min(patient3$y), min(patient4$y)), main = "Minimum Number of Seizures", names = c("Patient 3", "Patient 4"), ylim = c(0,5))

boxplot(patient3$y, patient4$y, main = "Number of Seizures", names = c("Patient 3", "Patient 4"))

hist(patient3$y, main = "Patient 3 Number of Seizures")
abline(v = mean(patient3$y), col = "orange")
```

</div>